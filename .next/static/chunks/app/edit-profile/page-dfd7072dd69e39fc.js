(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[819],{5225:function(e,t,r){Promise.resolve().then(r.bind(r,3833))},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9322:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(2972),a=r.n(n)},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},2119:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return a}});let n=r(3079);function a(e){let{createServerReference:t}=r(6671);return t(e,n.callServer)}},3833:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var n=r(7437),a=r(2265),s=r(7905),o=r(9376),i=r(2660),l=r(9322),c=r(3253),d=r(7648);r(3079);var u=(0,r(2119).$)("66d0f7fe39269b2dc3cb907ede7ccdeaa4620146"),g=()=>{let[e,t]=(0,a.useState)(!0),[r,g]=(0,a.useState)({first_name:"",last_name:"",about_me:"",age:"",gender:""}),[m,x]=(0,a.useState)({city:"",region:"",country:""}),[f,p]=(0,a.useState)([]),[h,b]=(0,a.useState)([]),[y,v]=(0,a.useState)([]),[j,N]=(0,a.useState)([]),[w,_]=(0,a.useState)([]),[S,k]=(0,a.useState)([]),[C,O]=(0,a.useState)([]),[P,I]=(0,a.useState)(!1),[Z,E]=(0,a.useState)(""),q=(0,o.useRouter)();(0,a.useEffect)(()=>{(async()=>{var e,r,n,a;t(!0);let{data:{user:o}}=await s.O.auth.getUser();if(!o){q.push("/login");return}let[i,l,c,d,u,m]=await Promise.all([s.O.from("profiles").select("*, locations(*)").eq("id",o.id).single(),s.O.from("profile_languages").select("languages(name)").eq("profile_id",o.id),s.O.from("profile_passions").select("passions(name)").eq("profile_id",o.id),s.O.from("languages").select("id, name"),s.O.from("passions").select("id, name"),s.O.rpc("get_distinct_countries")]),{data:f,error:h}=i;if(h&&"PGRST116"!==h.code){E("Failed to load profile."),console.error(h),t(!1);return}let y=(null===(e=l.data)||void 0===e?void 0:e.map(e=>{var t;return null===(t=e.languages)||void 0===t?void 0:t.name}).filter(e=>!!e))||[],j=(null===(r=c.data)||void 0===r?void 0:r.map(e=>{var t;return null===(t=e.passions)||void 0===t?void 0:t.name}).filter(e=>!!e))||[];f&&(g({first_name:f.first_name||"",last_name:f.last_name||"",about_me:f.about_me||"",age:(null===(a=f.age)||void 0===a?void 0:a.toString())||"",gender:f.gender||""}),f.locations&&(x({city:f.locations.city||"",region:f.locations.region||"",country:f.locations.country||""}),f.locations.country&&z(f.locations.country),f.locations.region&&L(f.locations.country,f.locations.region)),I(!0)),p(y),b(j),N(d.data||[]),v(u.data||[]),_((null===(n=m.data)||void 0===n?void 0:n.map(e=>e.country))||[]),t(!1)})()},[q]);let z=async e=>{let{data:t}=await s.O.rpc("get_distinct_regions",{p_country:e});k((null==t?void 0:t.map(e=>e.region))||[])},L=async(e,t)=>{let{data:r}=await s.O.rpc("get_distinct_cities",{p_country:e,p_region:t});O((null==r?void 0:r.map(e=>e.city))||[])},R=e=>{g({...r,[e.target.name]:e.target.value})},F=e=>{let{name:t,value:r}=e.target;x(e=>({...e,[t]:r})),"country"===t?(x(e=>({...e,region:"",city:""})),z(r)):"region"===t&&(x(e=>({...e,city:""})),L(m.country,r))},J=async e=>{e.preventDefault(),t(!0),E("");try{let e=await u({first_name:r.first_name,last_name:r.last_name,about_me:r.about_me,age:r.age?parseInt(r.age):null,gender:r.gender,location:{city:m.city||null,region:m.region||null,country:m.country||null},languages:f,passions:h});if(!e.success){if(e.details){let t=Object.values(e.details).flat().join(", ");throw Error(t)}throw Error(e.error)}q.push("/profile")}catch(e){console.error("Error updating profile:",e),E(e.message||"Failed to update profile")}finally{t(!1)}};return e?(0,n.jsx)("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:"Loading..."}):(0,n.jsx)("div",{className:"min-h-screen bg-black text-white p-6",children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,n.jsx)(d.default,{href:"/profile",className:"p-2 bg-gray-800 rounded-full hover:bg-gray-700 transition",children:(0,n.jsx)(i.Z,{size:24})}),(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Profile"})]}),Z&&(0,n.jsxs)("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-4 rounded-lg mb-6 flex items-center gap-3",children:[(0,n.jsx)(l.Z,{size:20}),Z]}),(0,n.jsxs)("form",{onSubmit:J,className:"space-y-8 bg-gray-900 p-8 rounded-2xl border border-gray-800",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"First Name"}),(0,n.jsx)("input",{type:"text",name:"first_name",value:r.first_name,onChange:R,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Last Name"}),(0,n.jsx)("input",{type:"text",name:"last_name",value:r.last_name,onChange:R,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",required:!0})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"About Me"}),(0,n.jsx)("textarea",{name:"about_me",value:r.about_me,onChange:R,rows:4,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"Tell us about yourself..."})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Age"}),(0,n.jsx)("input",{type:"number",name:"age",value:r.age,onChange:R,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",required:!0,min:"18"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Gender"}),(0,n.jsxs)("select",{name:"gender",value:r.gender,onChange:R,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",required:!0,children:[(0,n.jsx)("option",{value:"",children:"Select Gender"}),(0,n.jsx)("option",{value:"Male",children:"Male"}),(0,n.jsx)("option",{value:"Female",children:"Female"}),(0,n.jsx)("option",{value:"Non-binary",children:"Non-binary"}),(0,n.jsx)("option",{value:"Other",children:"Other"}),(0,n.jsx)("option",{value:"Prefer not to say",children:"Prefer not to say"})]})]})]}),(0,n.jsxs)("div",{className:"border-t border-gray-800 pt-6",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Location"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Country"}),(0,n.jsxs)("select",{name:"country",value:m.country,onChange:F,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[(0,n.jsx)("option",{value:"",children:"Select Country"}),w.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Region/State"}),(0,n.jsxs)("select",{name:"region",value:m.region,onChange:F,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",disabled:!m.country,children:[(0,n.jsx)("option",{value:"",children:"Select Region"}),S.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"City"}),(0,n.jsxs)("select",{name:"city",value:m.city,onChange:F,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 focus:outline-none",disabled:!m.region,children:[(0,n.jsx)("option",{value:"",children:"Select City"}),C.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]})]})]}),(0,n.jsxs)("div",{className:"border-t border-gray-800 pt-6",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Interests & Languages"}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(c.Z,{label:"Passions",options:y,selected:h,onChange:b,placeholder:"Select your passions..."}),(0,n.jsx)(c.Z,{label:"Languages",options:j,selected:f,onChange:p,placeholder:"Select languages you speak..."})]})]}),(0,n.jsx)("div",{className:"flex justify-end pt-6 border-t border-gray-800",children:(0,n.jsx)("button",{type:"submit",className:"px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg font-bold hover:shadow-lg transform hover:scale-105 transition",children:"Save Changes"})})]})]})})}},3253:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(7437),a=r(2265),s=r(2489);let o=(0,r(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var i=e=>{let{options:t,selected:r,onChange:i,label:l,placeholder:c}=e,[d,u]=(0,a.useState)(!1),[g,m]=(0,a.useState)(""),x=(0,a.useRef)(null);(0,a.useEffect)(()=>{function e(e){x.current&&!x.current.contains(e.target)&&u(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[x]);let f=e=>{r.includes(e)?i(r.filter(t=>t!==e)):i([...r,e])},p=e=>{i(r.filter(t=>t!==e))},h=t.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())),b="multiselect-".concat(l.replace(/\s+/g,"-").toLowerCase());return(0,n.jsxs)("div",{className:"relative",ref:x,children:[(0,n.jsx)("label",{htmlFor:b,className:"block text-sm font-medium text-gray-300 mb-2",children:l}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 p-2 border border-gray-700 rounded-lg bg-gray-900 cursor-text",onClick:()=>u(!0),children:[r.map(e=>(0,n.jsxs)("span",{className:"flex items-center gap-2 bg-indigo-600 text-white text-sm px-2 py-1 rounded-full",children:[e,(0,n.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),p(e)},className:"text-white hover:text-gray-200 focus:outline-none","aria-label":"Remove ".concat(e),children:(0,n.jsx)(s.Z,{size:14})})]},e)),(0,n.jsx)("input",{id:b,type:"text",className:"flex-grow bg-transparent border-none focus:ring-0 text-white placeholder-gray-500 min-w-[100px]",placeholder:0===r.length?c||"Select...":"",value:g,onChange:e=>m(e.target.value),onFocus:()=>u(!0),"aria-expanded":d,"aria-haspopup":"listbox"}),(0,n.jsx)(o,{className:"text-gray-400 ml-auto self-center",size:20})]}),d&&(0,n.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",role:"listbox",children:h.length>0?h.map(e=>(0,n.jsx)("div",{onClick:()=>f(e.name),className:"px-4 py-2 cursor-pointer hover:bg-gray-700 ".concat(r.includes(e.name)?"bg-indigo-900/50 text-indigo-300":"text-gray-300"),role:"option","aria-selected":r.includes(e.name),children:e.name},e.name)):(0,n.jsx)("div",{className:"px-4 py-2 text-gray-500",role:"option","aria-disabled":"true",children:"No options found"})})]})}},7905:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});let n=(0,r(9066).eI)("https://oyucjqjijrtipvssqxbc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95dWNqcWppanJ0aXB2c3NxeGJjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxNjM0NzUsImV4cCI6MjA2OTczOTQ3NX0.xzU_Qw-z0WbtUoLEaVPTrSXEAuDZt708p9kq2X6rsvo")}},function(e){e.O(0,[362,779,971,117,744],function(){return e(e.s=5225)}),_N_E=e.O()}]);